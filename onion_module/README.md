# 洋葱模型  

## 需求  

将一个函数数组，依次执行，并将返回结果逆执行顺序处理。以`JS` 为例：  

```js
// 需要将下面函数数组
var fns = [    
    // 其中next 应该指向下一个函数（的重新封装）
    (next) => { console.log(`1 in`); next(); console.log(`1 out`) },
    (next) => { console.log(`2 in`); next(); console.log(`2 out`) },
    (next) => { console.log(`3 in`); next(); console.log(`3 out`) },
    (next) => { console.log(`4 in`); next(); console.log(`4 out`) },
    (next) => { console.log(`5 in`); /* next(); */ console.log(`5 out`) },  // 中断了传递
    (next) => { console.log(`6 in`); next(); console.log(`6 out`) },
]

// 转化为如此调用的方式
// 执行顺序：函数体，next，函数体
// 相当于把依次把后面的函数重新封装传递给前面的函数作为参数
fns[0](() => {  // 这里的匿名函数就是next
    fns[1](() => {
        // ...
    });
});

/**
 * 函数调用栈
 * 
 * 调用|----------------|返回
 *     +----------------+
 *   + |                |
 *   | |      fn1       +<+
 *   | +----------------+ |
 *   +>+                | |
 *   | |      fn2       +<+
 *   | +----------------+ |
 *   +>+                | |
 *   | |      fn3       +<+
 *   | +----------------+ |
 *   +>+                | |
 *   | |      fn4       +<+
 *   | +----------------+ |
 *   +>+   +--------->  | +
 *     |      fn5       |
 *     +----------------+
 *     |                |
 *     |      fn6       |
 *     +----------------+
*/
```


## 实现

